{"version":3,"file":"js/701.d6049c60.js","mappings":"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","sources":["webpack://toutiao-two/./src/views/login/index.vue","webpack://toutiao-two/src/views/login/index.vue","webpack://toutiao-two/./src/views/login/index.vue?75e3","webpack://toutiao-two/./src/views/login/index.vue?a173","webpack://toutiao-two/./src/api/user.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"login-container\"},[_c('van-nav-bar',{staticClass:\"page-nav-bar\",attrs:{\"title\":\"登录\"}},[_c('van-icon',{attrs:{\"slot\":\"left\",\"name\":\"cross\"},on:{\"click\":function($event){return _vm.$router.back()}},slot:\"left\"})],1),_c('van-form',{ref:\"loginForm\",on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"name\":\"mobile\",\"maxlength\":\"11\",\"type\":\"number\",\"placeholder\":\"请输入手机号\",\"rules\":_vm.userFormRules.mobile},model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}},[_c('i',{staticClass:\"toutiao toutiao-shouji\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('van-field',{attrs:{\"name\":\"code\",\"maxlength\":\"6\",\"type\":\"number\",\"placeholder\":\"请输入验证码\",\"rules\":_vm.userFormRules.code},scopedSlots:_vm._u([{key:\"button\",fn:function(){return [(_vm.idCountDownShow)?_c('van-count-down',{attrs:{\"time\":1000*5,\"format\":\" ss \"},on:{\"finish\":function($event){_vm.idCountDownShow=false}}}):_c('van-button',{staticClass:\"send-sms-btn\",attrs:{\"size\":\"small\",\"type\":\"primary\",\"native-type\":\"button\"},on:{\"click\":_vm.onSendSms}},[_vm._v(\"发送验证码\")])]},proxy:true}]),model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}},[_c('i',{staticClass:\"toutiao toutiao-yanzhengma\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('div',{staticClass:\"login-btn-wrap\",staticStyle:{\"margin\":\"16px\"}},[_c('van-button',{staticClass:\"login-btn\",attrs:{\"block\":\"\",\"type\":\"info\",\"native-type\":\"submit\"}},[_vm._v(\"登录\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"login-container\">\r\n    <!-- 导航栏 -->\r\n    <van-nav-bar title=\"登录\" \r\n    class=\"page-nav-bar\">\r\n  <van-icon slot=\"left\" name=\"cross\" @click=\"$router.back()\" />\r\n    </van-nav-bar>\r\n\r\n    <!-- 登录表单 -->\r\n    <van-form ref=\"loginForm\" @submit=\"onSubmit\">\r\n\r\n      <!-- 手机 -->\r\n      <van-field v-model=\"user.mobile\"\r\n      name=\"mobile\" maxlength=\"11\"\r\n      type=\"number\" placeholder=\"请输入手机号\"\r\n      :rules=\"userFormRules.mobile\"\r\n     \r\n      >\r\n        <i slot=\"left-icon\" \r\n        class=\"toutiao toutiao-shouji\"></i>\r\n      </van-field>\r\n\r\n      <!-- 验证码 -->\r\n      <van-field\r\n       v-model=\"user.code\"\r\n        name=\"code\"\r\n           maxlength=\"6\"\r\n      type=\"number\"\r\n        placeholder=\"请输入验证码\"\r\n        :rules=\"userFormRules.code\">\r\n        <i slot=\"left-icon\" class=\"toutiao toutiao-yanzhengma\"></i>\r\n        <template #button>\r\n\r\n            <!-- 显示倒计时 -->\r\n            <van-count-down \r\n            v-if=\"idCountDownShow\"\r\n            :time=\"1000*5\" \r\n            format=\" ss \"\r\n            @finish=\"idCountDownShow=false\" />\r\n\r\n          <!-- 发送验证码按钮 -->\r\n          <van-button \r\n          v-else\r\n          class=\"send-sms-btn\"\r\n           size=\"small\" \r\n          type=\"primary\"\r\n          native-type=\"button\"\r\n          @click=\"onSendSms\"\r\n          >发送验证码</van-button>\r\n        </template>\r\n      </van-field>\r\n      <div class=\"login-btn-wrap\" style=\"margin: 16px;\">\r\n        <van-button class=\"login-btn\"\r\n         block type=\"info\"\r\n         native-type=\"submit\">登录</van-button>\r\n      </div>\r\n    </van-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { login,sendSms } from \"@/api/user\";\r\nexport default {\r\n  name: \"LoginIndex\",\r\n  data() {\r\n    return {\r\n      user: {\r\n        mobile: \"13774174101\",\r\n        code: \"246810\"\r\n        },\r\n    //   校验手机号和验证码的规则\r\n      userFormRules: {\r\n        mobile: [\r\n          {\r\n            required: true,\r\n            message: \"手机号不能为空\"\r\n          },\r\n          {\r\n            pattern: /^1[3|5|7|8|9]\\d{9}$/,\r\n            message: \"手机号格式不对\"\r\n          }\r\n          ],\r\n          code: [\r\n              {\r\n                  required: true,\r\n                message:'验证码不能为空',\r\n              },\r\n              {\r\n                  pattern: /^\\d{6}$/,\r\n                message:'验证码格式不对'\r\n              }\r\n        ]\r\n        },\r\n      idCountDownShow:false,  //是否展示倒计时\r\n    };\r\n  },\r\n  methods: {\r\n    // 表单提交事件\r\n    async onSubmit(values) {\r\n      console.log(\"submit\", values);\r\n      // 1.获取表单数据\r\n      const user = this.user;\r\n\r\n      // 2.表单验证\r\n      this.$toast.loading({\r\n        message: \"加载中...\",\r\n        forbidClick: true,\r\n        duration: 0 // 持续展示 toast 默认是 2000，如果为 0 则持续展示\r\n      });\r\n\r\n      // 3.表单请求登录\r\n      try {\r\n        const {data} = await login(user);\r\n          console.log(\"登陆成功\", data);\r\n        this.$store.commit('setUser',data.data)\r\n          this.$toast.success(\"登录成功\");\r\n\r\n        // 登录成功以后跳转到原来的页面\r\n          if (this.$route.query.backage) {\r\n          this.$router.push(this.$route.query.backage)\r\n        } else {\r\n          this.$router.back()\r\n        }\r\n      } catch (err) {\r\n        if (err.response && err.response.status === 400) {\r\n          // console.log(\"手机号或验证码错误\");\r\n          this.$toast.fail(\"手机号或验证码错误\");\r\n        } else {\r\n          //   console.log(\"登录失败，请稍后重试\", err);\r\n          this.$toast.fail(\"登录失败，请稍后重试\");\r\n        }\r\n      }\r\n      //   4.根据请求响应结果处理后续操作\r\n      },\r\n\r\n  \r\n    async  onSendSms() {\r\n          //  1. 校验手机号\r\n        //   给谁校验传递谁\r\n         \r\n          try {\r\n             await this.$refs.loginForm.validate('mobile')\r\n             console.log('验证通过');\r\n          } catch (err) {\r\n            return console.log('验证失败',err);\r\n          }\r\n\r\n        //   2.验证通过请求发送验证码显示倒计时\r\n          this.idCountDownShow = true\r\n        \r\n        // 3.请求发送验证码\r\n          try {\r\n           await sendSms(this.user.mobile)\r\n            this.$toast('发送成功')\r\n          } catch (err) {\r\n            // 发送失败关闭倒计时\r\n              this.idCountDownShow = false\r\n              if (err.response && err.response.status === 429) {\r\n                this.$toast('发送太频繁了，请稍后重试')\r\n              } else {\r\n                this.$toast('发送失败，请稍后重试')\r\n            }\r\n          }\r\n        \r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.login-container {\r\n  .toutiao {\r\n    font-size: 37px;\r\n  }\r\n\r\n  .send-sms-btn {\r\n    height: 46px;\r\n    line-height: 46px;\r\n    background-color: #ededed;\r\n    font-size: 22px;\r\n    color: #666;\r\n    border: none;\r\n  }\r\n\r\n  .login-btn-wrap {\r\n    padding: 53px 33px;\r\n    .login-btn {\r\n      background-color: #6db4fb;\r\n      border: none;\r\n      border-radius: 5px;\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=31f3ed09&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=31f3ed09&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"31f3ed09\",\n  null\n  \n)\n\nexport default component.exports","// 用户请求相关模块\r\n\r\nimport request from \"@/utils/request\";\r\n\r\n// import store from '@/store'\r\n\r\nconsole.log('用户请求相关模块', request);\r\nexport const login = data => {\r\n    return request({\r\n        method: \"POST\",\r\n        url: '/v1_0/authorizations',\r\n        data\r\n    })\r\n}\r\n\r\n// 发送短信验证码\r\n\r\nexport const sendSms = mobile => {\r\n    return request({\r\n        method: 'GET',\r\n        url:`/v1_0/sms/codes/${mobile}`\r\n    })\r\n}\r\n\r\n\r\n// 用户个人资料\r\nexport const getUserInfo = () => {\r\n    return request({\r\n        method: 'GET',\r\n        url: '/v1_0/user',\r\n        // // 发送请求头数据\r\n        // headers: {\r\n        //       // 注意：该接口需要授权才能访问，token的数据格式：Bearer token数据，注意 Bearer 后面有个空格\r\n        //     Authorization: `Bearer ${store.state.user.token}`\r\n        // }\r\n    })\r\n}\r\n\r\n// 获取用户选择的频道列表\r\nexport const getUserChannel = () => {\r\n    return request({\r\n        method: 'GET',\r\n        url:'/v1_0/user/channels'\r\n    })\r\n}\r\n\r\n\r\n// 添加关注 target 为作者id\r\nexport const addFollow = target => {\r\n    return request({\r\n        method: 'POST',\r\n        url: '/v1_0/user/followings',\r\n        data: {\r\n            target\r\n        }\r\n    })\r\n}\r\n// 取消关注 target 为作者id\r\nexport const deleteFollow = target => {\r\n    return request({\r\n        method: 'DELETE',\r\n        url: `/v1_0/user/followings/${target}`,\r\n    })\r\n}\r\n\r\n// 用户个人信息\r\nexport const getUserProfile = ()=> {\r\n    return request({\r\n        method: 'GET',\r\n        url:'/v1_0/user/profile'\r\n    })\r\n}\r\n\r\n// 更新用户个人信息\r\nexport const updataUserProfile = data => {\r\n    return request({\r\n        method: 'PATCH',\r\n        url: '/v1_0/user/profile',\r\n        data\r\n    })\r\n}"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","$event","$router","back","slot","ref","onSubmit","userFormRules","mobile","model","value","user","callback","$$v","$set","expression","code","scopedSlots","_u","key","fn","idCountDownShow","onSendSms","_v","proxy","staticStyle","staticRenderFns","name","data","required","message","pattern","methods","console","forbidClick","duration","component","log","request","login","method","url","sendSms","getUserInfo","getUserChannel","addFollow","target","deleteFollow","getUserProfile","updataUserProfile"],"sourceRoot":""}