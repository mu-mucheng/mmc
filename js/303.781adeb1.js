"use strict";(self["webpackChunktoutiao_two"]=self["webpackChunktoutiao_two"]||[]).push([[303],{8297:function(t,a,e){e.r(a),e.d(a,{default:function(){return E}});var o=function(){var t=this,a=t._self._c;return a("div",{staticClass:"user-profile"},[a("van-nav-bar",{staticClass:"page-nav-bar",attrs:{title:"个人信息","left-arrow":""},on:{"click-left":function(a){return t.$router.back()}}}),a("input",{ref:"file",attrs:{type:"file",hidden:""},on:{change:t.onFileChange}}),a("van-cell",{attrs:{title:"头像","is-link":""},on:{click:function(a){return t.$refs.file.click()}}},[a("van-image",{staticClass:"avatar",attrs:{fit:"cover",round:"",src:t.user.photo}})],1),a("van-cell",{attrs:{title:"昵称",value:t.user.name,"is-link":""},on:{click:function(a){t.isUpdataNameShow=!0}}}),a("van-cell",{attrs:{title:"性别",value:0===t.user.gender?"男":"女","is-link":""},on:{click:function(a){t.isUpdataGenderShow=!0}}}),a("van-cell",{attrs:{title:"生日",value:t.user.birthday,"is-link":""},on:{click:function(a){t.isUpdataBirthdayShow=!0}}}),a("van-popup",{staticClass:"popup",style:{height:"100%"},attrs:{position:"bottom"},model:{value:t.isUpdataNameShow,callback:function(a){t.isUpdataNameShow=a},expression:"isUpdataNameShow"}},[t.isUpdataNameShow?a("UpdataName",{on:{close:function(a){t.isUpdataNameShow=!1}},model:{value:t.user.name,callback:function(a){t.$set(t.user,"name",a)},expression:"user.name"}}):t._e()],1),a("van-popup",{staticClass:"popup",attrs:{position:"bottom"},model:{value:t.isUpdataGenderShow,callback:function(a){t.isUpdataGenderShow=a},expression:"isUpdataGenderShow"}},[t.isUpdataGenderShow?a("UpdataGender",{on:{close:function(a){t.isUpdataGenderShow=!1}},model:{value:t.user.gender,callback:function(a){t.$set(t.user,"gender",a)},expression:"user.gender"}}):t._e()],1),a("van-popup",{staticClass:"popup",attrs:{position:"bottom"},model:{value:t.isUpdataBirthdayShow,callback:function(a){t.isUpdataBirthdayShow=a},expression:"isUpdataBirthdayShow"}},[t.isUpdataBirthdayShow?a("UpdataBirthday",{on:{close:function(a){t.isUpdataBirthdayShow=!1}},model:{value:t.user.birthday,callback:function(a){t.$set(t.user,"birthday",a)},expression:"user.birthday"}}):t._e()],1),a("van-popup",{staticClass:"popup",attrs:{position:"bottom"},model:{value:t.isUpdataPhotoShow,callback:function(a){t.isUpdataPhotoShow=a},expression:"isUpdataPhotoShow"}},[a("UpdataPhoto")],1)],1)},n=[],i=e(2900),s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"updata-name"},[a("van-nav-bar",{attrs:{title:"设置昵称","left-text":"取消","right-text":"完成"},on:{"click-left":function(a){return t.$emit("close")},"click-right":t.onfinish}}),a("div",{staticClass:"field-wrap"},[a("van-field",{staticClass:"field",attrs:{rows:"2",autosize:"",autofocus:!0,type:"textarea",maxlength:"8",placeholder:"请输入昵称","show-word-limit":""},model:{value:t.localName,callback:function(a){t.localName="string"===typeof a?a.trim():a},expression:"localName"}})],1)],1)},r=[],l={name:"UpdataName",props:{value:{type:String,required:!0}},data(){return{localName:this.value}},methods:{async onfinish(){this.$toast.loading({message:"保存中...",forbidClick:!0,duration:0});try{if(!this.localName.length)return this.$toast("昵称不能为空");await(0,i.Ko)({name:this.localName}),this.$emit("input",this.localName),this.$emit("close"),this.$toast.success("设置成功")}catch(t){this.$toast.fail("设置失败")}}}},c=l,u=e(1001),d=(0,u.Z)(c,s,r,!1,null,"75db1e6f",null),h=d.exports,p=function(){var t=this,a=t._self._c;return a("div",{staticClass:"updata-gender"},[a("van-picker",{attrs:{title:"标题","show-toolbar":"",columns:t.columns,"default-index":t.value},on:{cancel:function(a){return t.$emit("close")},confirm:t.onConfirm,change:t.onPickerChange}})],1)},m=[],f={name:"UpdataGender",props:{value:{type:Number,required:!0}},data(){return{columns:["男","女"],localGender:this.value}},methods:{async onConfirm(){this.$toast.loading({message:"保存中...",forbidClick:!0,duration:0});try{await(0,i.Ko)({gender:this.localGender}),this.$emit("input",this.localGender),this.$emit("close"),this.$toast.success("设置成功")}catch(t){this.$toast("设置失败")}},onPickerChange(t,a,e){this.localGender=e}}},v=f,w=(0,u.Z)(v,p,m,!1,null,null,null),U=w.exports,g=function(){var t=this,a=t._self._c;return a("div",{staticClass:"updata-birthday"},[a("van-datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":t.minDate,"max-date":t.maxDate},on:{cancel:function(a){return t.$emit("close")},confirm:t.onConfirm},model:{value:t.currentDate,callback:function(a){t.currentDate=a},expression:"currentDate"}})],1)},b=[],k=e(5743),y=e.n(k),S={name:"UpdataBirthday",props:{value:{type:String,required:!0}},data(){return{minDate:new Date(1970,0,1),maxDate:new Date,currentDate:new Date(this.value)}},methods:{async onConfirm(){this.$toast.loading({message:"保存中...",forbidClick:!0,duration:0});try{await(0,i.Ko)({birthday:y()(this.currentDate).format("YYYY-MM-DD")}),this.$emit("input",y()(this.currentDate).format("YYYY-MM-DD")),this.$emit("close"),this.$toast.success("更新成功")}catch(t){this.$toast.fail("更新失败")}}}},$=S,C=(0,u.Z)($,g,b,!1,null,null,null),_=C.exports,x=function(){var t=this,a=t._self._c;return a("div",{staticClass:"updata-photo"},[t._v("1")])},G=[],D={name:"UpdataPhoto"},N=D,P=(0,u.Z)(N,x,G,!1,null,null,null),Z=P.exports,B={name:"UserProfile",data(){return{user:{},isUpdataNameShow:!1,isUpdataGenderShow:!1,isUpdataBirthdayShow:!1,isUpdataPhotoShow:!1}},created(){this.loadUserProfile()},methods:{async loadUserProfile(){try{const{data:t}=await(0,i.et)();console.log("用户个人信息",t),this.user=t.data}catch(t){this.$toast("获取数据失败")}},onFileChange(){const t=this.$refs.file.files[0];console.log("111",t);const a=window.URL.createObjectURL(t);console.log("222",a)}},components:{UpdataName:h,UpdataGender:U,UpdataBirthday:_,UpdataPhoto:Z}},T=B,Y=(0,u.Z)(T,o,n,!1,null,"6de41157",null),E=Y.exports},2900:function(t,a,e){e.d(a,{Ff:function(){return r},Ko:function(){return d},Q6:function(){return i},R3:function(){return l},VR:function(){return c},bG:function(){return s},et:function(){return u},x4:function(){return n}});var o=e(4471);console.log("用户请求相关模块",o.Z);const n=t=>(0,o.Z)({method:"POST",url:"/v1_0/authorizations",data:t}),i=t=>(0,o.Z)({method:"GET",url:`/v1_0/sms/codes/${t}`}),s=()=>(0,o.Z)({method:"GET",url:"/v1_0/user"}),r=()=>(0,o.Z)({method:"GET",url:"/v1_0/user/channels"}),l=t=>(0,o.Z)({method:"POST",url:"/v1_0/user/followings",data:{target:t}}),c=t=>(0,o.Z)({method:"DELETE",url:`/v1_0/user/followings/${t}`}),u=()=>(0,o.Z)({method:"GET",url:"/v1_0/user/profile"}),d=t=>(0,o.Z)({method:"PATCH",url:"/v1_0/user/profile",data:t})}}]);
//# sourceMappingURL=303.781adeb1.js.map